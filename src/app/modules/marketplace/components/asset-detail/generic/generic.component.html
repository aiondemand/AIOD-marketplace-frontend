<div *ngFor="let item of items">
  <div *ngFor="let col of columns" class="item-info-body">
    <div
      *ngIf="item[col] && item[col] !== 'N/A' && item[col] !== 'null'"
      class="item-info-container"
      [ngClass]="{'col': true, 'dark': isDarkTheme(), 'light': !isDarkTheme()}"
    >
      <h3>{{ formatColumnName(col) }}</h3>
      <div class="">
        <!-- Array type -->
  <div *ngIf="getValueType(item[col]) === VALUE_TYPES.ARRAY  && col !== 'description.plain'" class="">
          <span *ngFor="let arrayItem of getArrayValues(item[col]); let last = last" class="">
            {{ arrayItem }} 2<span *ngIf="!last">, </span>
          </span>
        </div>
        <!-- Distribution fields: show all items -->
        <div *ngIf="col === 'distribution'">
          <div *ngIf="getDistributionDependency()" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}">
            <strong>Dependency:</strong> {{ getDistributionDependency() }}
          </div>
          <div class="distribution-grid">
            <div *ngFor="let dist of item[col]" class="distribution-entry">
              <div *ngIf="dist.name" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}" ><strong>Name:</strong> {{ dist.name }}</div>
              <div *ngIf="dist.description" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}" ><strong>Description:</strong> {{ dist.description }}</div>
              <div *ngIf="dist.content_url" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}" ><strong>URL:</strong> <a style='color:#41b6e6' [href]="dist.content_url" target="_blank">{{ dist.content_url }}</a></div>
              <div *ngIf="dist.encoding_format" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}" ><strong>Encoding Format:</strong> {{ dist.encoding_format }}</div>
              <div *ngIf="dist.checksum" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}" ><strong>Checksum:</strong> {{ dist.checksum }}</div>
              <div *ngIf="dist.checksum_algorithm" [ngClass]="{'distribution-item': true, 'distribution-item-dark': isDarkTheme(), 'distribution-item-light': !isDarkTheme()}" ><strong>Checksum Algorithm:</strong> {{ dist.checksum_algorithm }}</div>
            </div>
          </div>
        </div>
        <!-- Object-array type -->
  <div *ngIf="getValueType(item[col]) === VALUE_TYPES.OBJECT_ARRAY && col !== 'description.plain' && col !== 'distribution'" class="object-array-media">
          <div *ngFor="let obj of item[col]" class="media-card">
              <h3 class="media-title">{{ getDistributionName() }}</h3>
            <div class="media-content"> 
              <div class="media-section" role="button" tabindex="0"
                   (click)="obj.showDescription = !obj.showDescription"
                   (keydown.enter)="obj.showDescription = !obj.showDescription"
                   (keydown.space)="$event.preventDefault(); obj.showDescription = !obj.showDescription"
                   style="cursor: pointer;">
                <div class="media-header" style="display:flex; align-items:center; justify-content:space-between; width:100%;">
                  <span class="media-desc-label">Description</span>
                  <mat-icon class="media-desc-arrow"
                            [attr.aria-label]="obj.showDescription ? 'Collapse' : 'Expand'"
                            [style.transform]="obj.showDescription ? 'rotate(180deg)' : 'rotate(0deg)'"
                            [style.transition]="'transform 180ms ease'"
                            [style.color]="'#5bc0f7'">expand_more</mat-icon>
                </div>
                <div class="dropdown-content" [ngClass]="{'animate-dropdown': obj.showDescription}">
                  <p class="media-description">{{ item['description.plain'] }}</p>
                </div>
              </div>
              <div class="media-section" role="button" tabindex="0"
                   (click)="obj.showProperties = !obj.showProperties"
                   (keydown.enter)="obj.showProperties = !obj.showProperties"
                   (keydown.space)="$event.preventDefault(); obj.showProperties = !obj.showProperties"
                   style="cursor: pointer;">
                <div class="media-header" style="display:flex; align-items:center; justify-content:space-between; width:100%;">
                  <span class="media-properties-label">Properties</span>
                  <mat-icon class="media-properties-arrow"
                            [attr.aria-label]="obj.showProperties ? 'Collapse' : 'Expand'"
                            [style.transform]="obj.showProperties ? 'rotate(180deg)' : 'rotate(0deg)'"
                            [style.transition]="'transform 180ms ease'"
                            [style.color]="'#5bc0f7'">expand_more</mat-icon>
                </div>
                <div class="media-properties-list dropdown-content" [ngClass]="{'animate-dropdown': obj.showProperties}">
                  <div class="media-property" *ngIf="obj.checksum_algorithm" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()}">
                    <div class="media-property-value">{{ obj.checksum_algorithm }}</div>
                    <div class="media-property-label">Checksum Algorithm</div>
                  </div>
                  <div class="media-property" *ngIf="obj.content_size_kb" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()}">
                    <div class="media-property-value">{{ obj.content_size_kb }}</div>
                    <div class="media-property-label">Content size (KB)</div>
                  </div>
                  <div class="media-property" *ngIf="obj.content_url" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()}">
                    <div class="media-property-value">
                      <a [href]="obj.content_url" target="_blank">{{ obj.content_url }}</a>
                    </div>
                    <div class="media-property-label">Content URL</div>
                  </div>
                  <div class="media-property" *ngIf="obj.copyright" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()}">
                    <div class="media-property-value">{{ obj.copyright }}</div>
                    <div class="media-property-label">Copyright</div>
                  </div>
                  <div class="media-property" *ngIf="obj.date_published" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()} ">
                    <div class="media-property-value">{{ obj.date_published }}</div>
                    <div class="media-property-label">Date Published</div>
                  </div>
                </div>
              </div>
            </div>
                <div style=" padding-top: 2rem;">
                  <a *ngIf="obj.content_url" [href]="obj.content_url" style="color: #41b6e6" target="_blank">
                    <mat-icon style="vertical-align: middle; font-size: 16px; height: unset;">open_in_new</mat-icon>
                    <span style="margin-left: 6px; vertical-align: middle;">Source</span>
                  </a>
                </div>
          </div>
        </div>
        <!-- Normal type -->
        <markdown *ngIf="col === 'description.plain'" class="markdown-white">
          {{ item[col] }}
        </markdown>
        <markdown *ngIf="col === 'license'" class="license" style="color: blue;">
          {{ item[col] }}
        </markdown>
        <markdown *ngIf="col === 'same_as'" class="same_as">
          {{ item[col] }}
        </markdown>
        <markdown *ngIf="col === 'execution_settings'" class="execution_settings" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()}">
          {{ item[col] }}
        </markdown>
        <markdown *ngIf="col === 'badge'" class="badge" [ngClass]="{'dark': isDarkTheme(), 'light': !isDarkTheme()}">
          {{ item[col] }}
        </markdown>
        <markdown *ngIf="col === 'type'" class="badge">
          {{ item[col] }}
        </markdown>
      </div>
    </div>
  </div>
</div>
